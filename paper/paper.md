---
title: 'Interfere: Studying Intervention Response Prediction in Complex Dynamic Models'
tags:
  - Python
  - dynamics
  - stochastic differential equations
  - forecasting
  - time series
  - non linear
  - chaotic
  - simulation
  - modeling
  - complex systems
  - causality
  - intervention
  - manipulation
authors:
  - name: D. J. Passey
    orcid: 0000-0002-9310-3361
    affiliation: 1
  - name: Alice C. Schwarze
    orcid: 0000-0002-9146-8068
    affiliation: 2
  - name: Zachary M. Boyd
    orcid: 0000-0002-6549-7295
    affiliation: 3
  - name: Peter J. Mucha
    orcid: 0000-0002-0648-7230
    affiliation: 2
affiliations:
  - name: University of North Carolina at Chapel Hill, United States
    index: 1
    ror: 0130frc33
  - name: Dartmouth College, United States
    index: 2
    ror: 049s0rh22
  - name: Brigham Young University, United States
    index: 3
    ror: 047rhhm47
date: 20 May 2025
bibliography: paper.bib
---
# Summary

The Interfere package focuses on *intervention response prediction*â€”forecasting how complex, dynamic systems respond to novel interventions. 
While ideal data for benchmarking predictive methods for such problems would come from controlled, longitudinal experiments, such experiments are often infeasible due to confounding, cost, and ethical constraints. 
In contrast, many synthetic benchmarks rely on models with static linear relationships and/or independent noise profiles that lack the complex interdependent feedback present in the real world.
However, many disciplines, including economics, ecology, and systems biology, employ mechanistic dynamic models [@brayton_frbus_2014; @izhikevich_large-scale_2008; @banks_parameter_2017; @baker_mechanistic_2018]
with evidence demonstrating they capture important real-world characteristics. 
We propose using datasets generated by such complex systems to benchmark methods that predict intervention response. 
If a model captures important real-world characteristics and a method can accurately predict intervention response *for that model* then the method might also predict intervention response for similar real-world systems.
Interfere works towards this vision by combining (1) a general interface for simulating interventions on dynamic models, (2) a suite of predictive methods and cross-validated hyperparameter optimization tools, and (3) an [extensible benchmark data set](https://drive.google.com/file/d/19_Ha-D8Kb1fFJ_iECU62eawbeuCpeV_g/view?usp=sharing) of dynamic intervention response scenarios (see Figure \ref{fig:sixty_models}).

![Three-dimensional trajectories of sixty scenarios from differential equation and discrete time difference equation models. 
Blue trajectories represent natural behavior of the system.
Red depicts response to a specified intervention.
The three dimensions with highest variance are shown. 
These sixty scenarios comprise the downloadable [Interfere Benchmark 1.1.1](https://drive.google.com/file/d/19_Ha-D8Kb1fFJ_iECU62eawbeuCpeV_g/view?usp=sharing).
\label{fig:sixty_models}](../images/sixty_models.png)

# Statement of Need

![**Original System Trajectory (Left):** The natural evolution of the quadratic Belozyorov system [@belozyorov_exponential_2015] with small stochastic noise.
**System Trajectory After Intervention (Center):** Exogenous control of $x(t)$ by $\text{do}(x(t)=\sin(t))$ for $t>10$ affects $y(t)$. 
The intervention (black) and response (blue) indicate clear departure from natural behavior (green and gray). 
**Intervention Response Prediction (Right):**
Equation discovery by SINDy [@brunton_discovering_2016] is fit to data prior to the intervention to predict intervention response (red).](../images/interfere_usage_combined.png)

Multiple frameworks have emerged for identifying causal relationships from data [@imbens_causal_2015; @pearl_causality_2009; @wieczorek_information_2019].
Many frameworks assume a static, linear relationship.
Because a linear approximation can be insufficient for anticipating the response of complex dynamic systems at medium and long times, 
non-linear, dynamic techniques have been developed for causal discovery and forecasting [e.g. @runge_discovering_2022]. Nevertheless, there are relatively few intervention oriented techniques to fit dynamic nonlinear models to data. 

Interfere's benchmarking approach is enabled by a unified toolkit for simulating intervention response, standardized method evaluation, and systematic cross-validation across diverse dynamic systems. 
By lowering barriers to method evaluation, Interfere facilitates  development of prediction methods that translate from theory to real-world application.

# Primary Contributions

Interfere provides (1) dynamically diverse counterfactuals, (2) cross-disciplinary forecast methods, and (3) comprehensive and extensible benchmarking.

![Can stochasticity help reveal associations between variables? In this example, Interfere compares intervention response prediction for deterministic and stochastic versions of the same system.
 \label{fig:det_vs_stoch}](../images/det_v_stoch.png)

## 1. Dynamically Diverse Counterfactuals at Scale

Whereas many predictive methods are typically benchmarked on $<10$ systems [@challu_nhits_2023; @brunton_discovering_2016; @vlachas_backpropagation_2020; @pathak_model-free_2018; @prasse_predicting_2022], Interfere's "dynamics" submodule contains $>50$ models, including linear, nonlinear, chaotic, continuous-time, discrete-time, stochastic, and deterministic models, from disciplines including finance, ecology, biology, neuroscience and public health. Most importantly, Interfere is built for studying interventions: the inherited "BaseDynamics" type allows exogenous control of any observed state, added measurement noise, and, for most models, stochasticity parameterized by a scalar or covariance matrix. Interfere thus offers a user-friendly framework to produce complex dynamic intervention response and forecasting scenarios at scale.

## 2. Cross-Disciplinary Forecast Methods

Interfere integrates dynamic forecasting methodologies from deep learning (LSTM, NHITS), applied mathematics (SINDy, Reservoir Computers) and social science (VAR). The "ForecastingMethod" class is expressive enough to describe, fit and predict with multivariate dynamic models, and apply interventions to model states. 

## 3. Comprehensive and Extensible Benchmarking

The [Interfere Benchmark](https://drive.google.com/file/d/19_Ha-D8Kb1fFJ_iECU62eawbeuCpeV_g/view?usp=sharing) is a comprehensive and extensible set containing $60$ intervention response scenarios for testing, each simulated with different levels of stochastic noise. Each scenario is housed in a JSON file, with metadata annotation, documentation, versioning and commit hashes marking the Interfere commit used to generate data.  
Scenarios were reviewed by hand with exogenous input such that none of the key variables settle to steady state. Interventions were chosen so target variable response significantly departs from prior behavior. We aim for this benchmark to facilitate future progress towards predicting how complex systems respond to never before seen situations.

# Related Software and Mathematical Foundations

## Predictive Methods

Interfere draws from the Nixtla open source ecosystem for time series forecasting, including cross validation and hyperparameter optimization. We implemented intervention support for LSTM and NHITS from the NeuralForecast package, and for ARIMA from the StatsForecast package [@olivares2022library_neuralforecast; @garza2022statsforecast]. Interfere includes predictive methods from the PySINDy [@kaptanoglu2022] and StatsModels [@seabold2010statsmodels] packages. We also include ResComp, a reservoir computing method for forecasts [@harding_global_2024]. Hyperparameter optimization is designed around the Optuna framework [@akiba2019optuna].

Integrating a method into Interfere requires that the method supports (1) multivariate endogenous dynamic forecasting, (2) exogenous variables, and (3) flexible length forecast windows or recursive predictions. While few forecasting methods meet these criteria, we hope Interfere will encourage development of additional methods.

# Acknowledgements

This work was supported by an NSF Graduate Research Fellowship (DJP) and Army Research Office award W911NF2510049. The content is solely the responsibility of the authors.

# References