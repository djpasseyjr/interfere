---
title: 'Interfere: Studying Intervention Response Prediction in Complex Dynamic Models'
tags:
  - Python
  - dynamics
  - stochastic differential equations
  - forecasting
  - time series
  - non linear
  - chaotic
  - simulation
  - modeling
  - complex systems
  - causality
  - intervention
  - manipulation
authors:
  - name: D. J. Passey
    orcid: 0000-0002-9310-3361
    affiliation: 1
  - name: Alice C. Schwarze
    orcid: 0000-0002-9146-8068
    affiliation: 2
  - name: Zachary M. Boyd
    orcid: 0000-0002-6549-7295
    affiliation: 3
  - name: Peter J. Mucha
    orcid: 0000-0002-0648-7230
    affiliation: 2
affiliations:
  - name: University of North Carolina at Chapel Hill, United States
    index: 1
    ror: 0130frc33
  - name: Dartmouth College, United States
    index: 2
    ror: 049s0rh22
  - name: Brigham Young University, United States
    index: 3
    ror: 047rhhm47
date: 20 May 2025
bibliography: paper.bib
---
# Summary

The Interfere package focuses on *intervention response prediction*â€”forecasting how complex, dynamic systems respond to novel interventions. When developing predictive
methods capable of solving this problem, ideal benchmarking data comes from
controlled, longitudinal experiments. Such experiments are often infeasible due
to confounding, cost, and ethical constraints. 

Synthetic benchmarks, which are often used in response to this problem [cite], typically rely on models
with static linear relationships and overly independent noise profiles that lack
the complex interdependent feedback we find in the real world.

As a solution, we propose a middle ground: Scientists in many disciplines, such
as economics, ecology, systems biology and others, employ mechanistic dynamic
models as a part of their research and application toolkit [@brayton_frbus_2014;
@izhikevich_large-scale_2008; @banks_parameter_2017; @baker_mechanistic_2018].
Many of these models are accompanied by a body of evidence demonstrating that
they do indeed capture important characteristics of the real world problems they
emulate. 
Instead of using simple synthetic data for benchmarking, we propose using data
generated by detailed scientific models as a ground truth against which we can
benchmark methods that predict intervention response. 

The logic is this: Methods that accurately predict intervention responses of
scientific models should generalize to real-world processes insofar as these
models capture them.



Interfere offers the first steps towards this vision by combining (1) a general interface for simulating the effect of interventions on dynamic models, (2) a suite of predictive methods and cross validated hyper parameter optimization tools, and (3) the first known [extensible benchmark data set](https://drive.google.com/file/d/19_Ha-D8Kb1fFJ_iECU62eawbeuCpeV_g/view?usp=sharing) of dynamic intervention response scenarios see Figure \ref{fig:sixty_models}.

![Three-dimensional trajectories of sixty scenarios simulated with the Interfere
package. Simulated models are either differential equations or discrete time
difference equations. Trajectories in blue represent the natural behavior of
the system, while red depicts response to a specified intervention.
For models with more than three dimensions,
only the three dimensions with highest variance
are shown. These sixty scenarios, making up the [Interfere Benchmark 1.1.1](https://drive.google.com/file/d/19_Ha-D8Kb1fFJ_iECU62eawbeuCpeV_g/view?usp=sharing) for
intervention response prediction, are available for download.
\label{fig:sixty_models}](../images/sixty_models.png)

# Statement of Need

![**Original System Trajectory (Left):** The natural, uninterupted evolution of
the quadratic Belozyorov system [@belozyorov_exponential_2015] simulated using
the Interfere package with a small
amount of stochastic noise.
**System Trajectory After Intervention (Center):** The
effect that taking exogenous control of $x(t)$ by via $\text{do}(x(t)=\sin(t))$
beginning at time $t=10$
has on $y$. The intervention (black) and
response (blue), depict a clear departure from
the natural behavior of the system (green and gray). **Intervention Response
Prediction (Right):**
Example of forecasting the response of
the Belozyorov system to the sinusoidal intervention. The ground truth response, $y(t)$ for
$t > 10$ is plotted in blue. Here, an equation discovery algorithm, SINDy,
[@brunton_discovering_2016] is fit to the data that occurs prior to the
intervention and makes an attempt to predict the intervention response (red
curve).
](../images/interfere_usage_combined.png)

Over the past twenty years, multiple frameworks have emerged for identifying causal relationships in observational
data [@imbens_causal_2015; @pearl_causality_2009; @wieczorek_information_2019].
The most influential frameworks are probabilistic and, while it is not a necessary
condition for identifying causality, a static, linear relationship has
often been assumed. However, when attempting to anticipate the response of complex dynamic
systems in the medium and long term, a linear approximation of the dynamics can be
insufficient.  Therefore, 
non-linear, dynamic techniques have been employed for causal discovery and forecasting [e.g. @runge_discovering_2022]. Nevertheless,
there are relatively few techniques that are able to fit causal dynamic
nonlinear models to data. 

Leveraging recent advancements in causal inference and historical work in dynamic modeling and simulation, we focus on a key problem --- predicting how a complex system responds to a previously unobserved intervention --- and designed the Interfere package for benchmarking tools aimed at this intervention response prediction. The dynamic models contained in Interfere present challenges for this prediction that likely require incorporating mechanistic assumptions alongside probabilistic frameworks for causality. Interfere allows researchers to validate predictive dynamic methods against simulated intervention scenarios, encouraging cross-pollination between probabilistic causal inference and modeling/simulation perspectives.

# Primary Contributions

Interfere provides three primary contributions: (1) dynamically diverse counterfactuals, (2) cross-disciplinary forecast methods, and (3) comprehensive and extensible benchmarking.

![Example experimental setup possible with Interfere: Can stochasticity help reveal associations between variables? Interfere can be used to compare intervention response prediction for deterministic and stochastic versions of the same system.
 \label{fig:det_vs_stoch}](../images/det_v_stoch.png)

## 1. Dynamically Diverse Counterfactuals at Scale

Whereas most predictive methods for complex dynamics are typically benchmarked on fewer than ten systems [@challu_nhits_2023; @brunton_discovering_2016; @vlachas_backpropagation_2020; @pathak_model-free_2018; @prasse_predicting_2022], Interfere's "dynamics" submodule contains over fifty dynamic models, with a mix of linear, nonlinear, chaotic, continuous-time, discrete-time, stochastic, and deterministic models, from a variety of disciplines including finance, ecology, biology, neuroscience and public health. Most importantly, Interfere is built for studying interventions: each model inherits the Interfere BaseDynamics type, with possible exogenous control of any observed state, added measurement noise, and, for most models, stochasticity controlled by a scalar parameter or fine tuned with a covariance matrix. Interfere thus offers a user-friendly framework to produce complex dynamic intervention response and standard forecasting scenarios at scale.

## 2. Cross Disciplinary Forecast Methods

Interfere integrates dynamic *forecasting* methodologies from deep learning (LSTM, NHITS), applied mathematics (SINDy, Reservoir Computers) and social science (VAR). The Interfere "ForecastingMethod" class is expressive enough to describe, fit and predict with multivariate dynamic models and apply interventions to the states of the models during prediction. 

## 3. Comprehensive and Extensible Benchmarking

Interfere organizes a variety of dynamic scenarios into the [Interfere Benchmark](https://drive.google.com/file/d/19_Ha-D8Kb1fFJ_iECU62eawbeuCpeV_g/view?usp=sharing), a comprehensive and extensible set containing 60 intervention response scenarios for testing, each simulated with different levels of stochastic noise. Each scenario is housed in a JSON file, with metadata annotation, documentation, versioning and commit hashes marking the commit of Interfere that was used to generate the data. The scenarios were reviewed by hand with some systems exposed to exogenous input to ensure that none of the key variables settle into a steady state. Additionally, all interventions were chosen so that the target variable response significantly departs from its prior behavior. We aim for this benchmark to facilitate future progress towards correctly anticipating how complex systems will respond to never before seen scenarios.

# Related Software and Mathematical Foundations

## Predictive Methods

Interfere draws from the Nixtla open source ecosystem for time series forecasting. We implemented intervention support for LSTM and NHITS from the NeuralForecast package, and for ARIMA from the StatsForecast package [@olivares2022library_neuralforecast; @garza2022statsforecast]. We followed Nixtla's example for cross validation and hyperparameter optimization approaches. We integrated predictive methods from the PySINDy [@kaptanoglu2022] and StatsModels [@seabold2010statsmodels] packages. We also include ResComp, a reservoir computing method for global forecasts from [@harding_global_2024]. Hyperparameter optimization is designed around the Optuna framework [@akiba2019optuna].

While other forecasting methods exist, integrating a method with Interfere requires that the method is capable of (1) multivariate endogenous dynamic forecasting, (2) support for exogenous variables, and (3) support for flexible length forecast windows or recursive predictions. Few forecasting methods meet these criteria, and it is our hope that this package will encourage development of additional methods.

# Acknowledgements

The work described here was supported by an NSF Graduate Research Fellowship (DJP) and by award W911NF2510049 from the Army Research Office. The content is solely the responsibility of the authors and does not necessarily represent the official views of any agency.

# References